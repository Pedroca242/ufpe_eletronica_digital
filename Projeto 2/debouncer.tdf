INCLUDE "contador.inc";

SUBDESIGN debouncer
(
	button : INPUT;
	clock : INPUT;
	result : OUTPUT;
)
VARIABLE 
	ff[2..0] : dff;
	divisor : contador WITH (overflow = 1000000); -- 40ms = 25Hz

BEGIN
	divisor.clock = clock;
	count.clr = !(ff[0] $ ff[1]);
	count.ena = !count.clock_out
	
	ff[1..0].clk = clock;
	ff[0].d = !button;
	ff[1].d = ff[0].q;
	ff[2].d = ff[1].q;

	IF divisor.clk_out == 1 THEN
		ff[2].clk = clock;
	END IF;

	result = !ff[2].q;
END;